function convertToSlug(e){return e.toLowerCase().replace(/[^a-zA-Z0-9]+/g,"-")}function getUrlParameter(e){var a,t,r=window.location.search.substring(1).split("&");for(t=0;t<r.length;t++)if((a=r[t].split("="))[0]===e)return void 0===typeof a[1]||decodeURIComponent(a[1]);return!1}function copyImageHTMLTagToClipboard(e){$("#images a.tooltip.tip-top span.tip").html("Copy image HTML tag to clipboard");var a=document.getElementById("image_html_tag_"+e);a.select(),a.setSelectionRange(0,99999),document.execCommand("copy"),document.getElementById("copy_img_tip_"+e).innerHTML="Copied: "+a.value.replace("<","&lt;").replace(">","&gt;").replace('"',"&quot;")}$(document).ready((function(){var e=window.location.pathname;(e.indexOf("/categories/new")+1||e.indexOf("/categories/edit")+1||e.indexOf("/topics/new")+1||e.indexOf("/topics/edit")+1)&&$("#id_slug").length&&0==$("#id_slug").val().length&&$("#id_en_name").on("keyup",(function(){$("#id_slug").val(convertToSlug($("#id_en_name").val()))})),e.indexOf("/articles/upload_images")+1&&(document.querySelector("#upload_images").addEventListener("change",(function(e){$("#loading_bar").hide(),$("#upload_btn").hide(),$("#upload_images_error").hide();for(var a,t=e.target.files,r=[],i=!1,l=$("#upload_images").attr("accept").split(","),s=$("#upload_images_error").attr("f_max_size"),n=($("#upload_images_error").attr("f_max_total"),0);a=t[n];n++){var o="."+a.name.toLowerCase().split(".").slice(-1);a.size>=s||-1===$.inArray(o,l)?(r.push('<li class="text-danger">'),i=!0):r.push("<li>"),r.push("<b>",a.name,"</b> [",readableFileSize(a.size),', "',a.type||"n/a",'"]</li>')}$("#images_list").html("<ul>"+r.join("")+"</ul>"),0==i?$("#upload_btn").show():$("#upload_images_error").show()}),!1),document.querySelector("#upload_btn").addEventListener("click",(function(){if(0==document.querySelector("#upload_images").files.length)return void alert("Error: No file selected");$("#loading_bar").show();let a=$("#loading_bar div.bar"),t=new FormData;for(var r=document.getElementById("upload_images").files.length,i=0;i<r;i++)t.append("images[]",document.getElementById("upload_images").files[i]);let l=new XMLHttpRequest;l.open("POST",e),l.setRequestHeader("X-CSRFToken",$("#csrf_token").attr("value")),l.upload.addEventListener("progress",(function(e){let t=e.loaded/e.total*100;a.css({width:t+"%"}),t<=10&&a.addClass("danger").removeClass("warning secondary primary success"),t<=25&&t>10&&a.addClass("warning").removeClass("danger secondary primary success"),t<=50&&t>25&&a.addClass("secondary").removeClass("danger warning primary success"),t<=75&&t>50&&a.addClass("primary").removeClass("danger warning secondary success")})),l.addEventListener("load",(function(e){if(200==l.status){var t=JSON.parse(l.response),r=[];if("1"!=getUrlParameter("list")){for(var i=0;s=t[i];i++)r.push('<tr><td class="text-center"><a onclick="copyImageHTMLTagToClipboard(\'',s.id,'\');" class="tooltip tip-right">Copy image tag<span class="tip" id="copy_img_tip_',s.id,'">Copy image HTML tag to clipboard</span></a><br><a href="',s.del_url,'">Delete</a>','</td><td><a href="',s.url,'" target="_blank">',s.name,"</a></td>",'<td class="text-center"><a href="',s.url,'" target="_blank"><img src="',s.url,'"></a></td>','<td class="text-center">',readableFileSize(s.size),"</td>",'<td><input id="image_html_tag_',s.id,'" value="&lt;img src=&quot;',s.path,'&quot;&gt;"></td></tr>');$("#images tbody").html(r.join(""))}else{var s;for(i=0;s=t[i];i++)r.push('<li><a href="',s.url,'" target="_blank">',s.name,"</a> [",readableFileSize(s.size),'] (<a href="',s.del_url,'">',"Delete","</a>)</li>");$("#images ul").html(r.join(""))}}$("#upload_btn").hide(),a.css({width:"100%"}).addClass("success").removeClass("danger warning secondary primary")})),l.send(t)})))}));